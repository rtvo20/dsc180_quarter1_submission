# Quarter 1 Project:
This project uses data from David Fenning's Solar Energy Innovation Laboratory (SOLEIL) that creates solar cell samples. The data they collect are information from the manufacturing process of these solar cells, along with data they collect when testing the samples. Our project cleans and transforms the data, which are originally in JSON format, before saving them as CSVs that allow it to be imported and graphed in Neo4j, a Graph DBMS. The purpose of this task is to have a pipeline that can organize and transform the data so that it can be graphed in Neo4j and can be queried.

Input data are JSON files containing information from the SOLEIL lab in the form of a worklist. Our functions extract data from these worklists, such as step names (e.g. 'drop', 'spin', 'hotplate'), chemical names, and output data (measurements and tests done on the resulting sample). Running ```run.py``` on the  input data gives us the output data file, which can be used to generate our output, a graph representation of the data.

The output data (CSVs) after they are cleaned and transformed are run through a function that generates a script file with queries in Neo4j's query language, Cypher. The script (a .cypher file) automates the process to graph the data using Neo4j's Cypher shell terminal. To run the script, we use a Docker container running Neo4j, which requires us to copy this 'output.cypher' file into the docker container's root directory before we can run it with a command. All of the instructions to do so are located in the section below.

This current iteration includes test data under test/testdata, which is one sample from some actual data to show how our code works on "barebones" test data.

More detailed instructions are below, however an overview of the process to reproduce our results:
1. run ```python run.py test``` to generate a script file with queries to generate a graph's nodes and links.
2. Using Docker, pull the latest Neo4j Docker image and start a container with this image.
   * Copy the script file from DSMLP to the local setting, then copy it to the docker container's root directory
   * Open a terminal in the docker container and run the script file and produce the results.

## To run the project use run.py and follow the instructions below.

* The filepaths to the test data are already coded into ```run.py``` and are under the folder "test/testdata".
* The available targets for running ```python run.py <target>``` and the order of the targets are:
    * ```data```>```features```>```queries```
    * Alternatively, running the command ```python run.py test``` is equivalent to running each of the above targets sequentially.
* Running ```run.py``` cleans and transforms the data and creates queries in Neo4j's query language (Cypher) that allows for nodes and links to be graphed. Each graph in our implementation currently requires 6 queries to create and link all the nodes, so to help automate the process, the output of ```run.py``` is a Neo4j script-type file (.cypher file) that performs all of these queries in less inputs than doing so manually.
  * Our output file is named "output.cypher" and will be located in the project's root directory.
  
## To run the script generated by run.py in the above steps, use Docker.
* In order to run this script, a docker container has to be created with Neo4j's docker image.
* To recreate and run our output, follow the steps below:
  * With Docker desktop open, in a local terminal, run ```docker pull neo4j``` and start a docker container with the Neo4j docker image.
    * Run the following command in a local terminal, which creates a Neo4j session and allows for access to the Neo4j Browser UI via port 7474 (localhost:7474)   
    * ```docker run --name neo4j_session -p7474:7474 -p7687:7687 -d --env NEO4J_AUTH=neo4j/test neo4j:latest```
    * This browser is able to perform queries similar to SQL, but in Neo4j's graph query language instead, which will allow us to see the graphed data.
  * The next step is copying the "output.cypher" file into the docker container's root directory by running the following command in the local terminal
    * (if running from a local environment, this would also require downloading/copying the output.cypher file from the DSMLP environment to the local first)
    * In the local terminal, ```cd``` to the directory where "output.cypher" is located. Then run the following command, also in the local terminal:
    * ```docker cp output.cypher neo4j_session:/output.cypher```
  * Once this is done, open the docker container terminal and run the following commands:
  (The image below shows how to open the container's terminal)
  ![image](https://user-images.githubusercontent.com/59627502/206329650-a2068903-ea1e-4aa5-9936-a31d6dfd1ffc.png)
    * ```cd /``` to change to the root directory
    * ```cypher-shell -f output.cypher -u neo4j -p test``` Which will execute the script file and begin to generate the nodes and links of the graph.
    * The script should run and generate feedback like in the screenshot below.
  ![image](https://user-images.githubusercontent.com/59627502/206329844-ad5ba27c-c776-4a8f-b0b9-8f3cce2cdebb.png)

  * Finally, in Neo4j's browser UI at localhost:7474, the following query can be entered to return the graph in order to see the output.
    * ```MATCH(n) RETURN n``` which returns all of the nodes and relationships, which should show the graphed sample, as in the expected outut below.
    ![image](https://user-images.githubusercontent.com/59627502/206330150-f68f88ec-39a4-4bbe-8ece-ea8a95d7ee03.png)

    
